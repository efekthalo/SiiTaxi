﻿@using SiiTaxi.Models;
@model SiiTaxi.Models.TaxiViewModel
@{
    ViewBag.Title = "Administracja";
}
<h2>Administracja</h2>
@if (TempData["errorMessage"] != null)
{
    <div class="alert alert-danger">
        <strong>Błąd!</strong> @TempData["errorMessage"]
    </div>
}
@if (TempData["successMessage"] != null)
{
    <div class="alert alert-success">
        <strong>Sukces!</strong> @TempData["successMessage"]
    </div>
}
<ul class="nav nav-pills">
    <li role="presentation" class="active">@Html.ActionLink("Taxi", "Taxi", "Admin")</li>
    <li role="presentation">@Html.ActionLink("Approvers", "Index", "Approvers")</li>
    <li role="presentation">@Html.ActionLink("Zarządzaj kontem", "Index", "Manage")</li>
</ul>

<div>
    <table class="table table-hover table-responsive">
        <thead>
            <tr class="thead-inverse">
                <th>#</th>
                <th>Start</th>
                <th>Cel</th>
                <th>Data i godzina</th>
                <th>Pasażerowie</th>
                <th>Approver</th>
                <th>PO</th>
                <th>Z</th>
                <th>Kod Taxi</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var taxi in Model.Taxis)
            {
                <tr>
                    <th scope="row">@taxi.TaxiId</th>
                    <td>@taxi.From</td>
                    <td>@taxi.To</td>
                    <td>@taxi.Time.ToString("dd/MM/yyyy HH:mm")</td>
                    <td>
                        <ul class="list-group">
                            <li class="list-group-item">
                                @taxi.People.Name<span class="badge">owner</span>
                            </li>
                            @for (var i = 0; i < taxi.TaxiPeople.Count; i++)
                            {
                                <li class="list-group-item">@taxi.TaxiPeople.ElementAt(i).People.Name</li>
                            }
                        </ul>
                    </td>
                    <td>@taxi.People1.Name</td>
                    <td style="text-align: center;">
                        @if (taxi.IsConfirmed)
                        {
                            <span class="glyphicon glyphicon glyphicon-ok" aria-hidden="true"></span>
                        }
                        else
                        {
                            <span class="glyphicon glyphicon glyphicon-remove" aria-hidden="true"></span>
                        }
                    </td>
                    <td style="text-align: center;">
                        @if (taxi.IsOrdered)
                        {
                            <span class="glyphicon glyphicon glyphicon-ok" aria-hidden="true"></span>
                        }
                        else
                        {
                            <span class="glyphicon glyphicon glyphicon-remove" aria-hidden="true"></span>
                        }
                    </td>
                    <td class="col-md-2">
                        
                        <form name="codeForm" class="input-group" method="post" action="@Url.Action("SendCode", "Admin", new { id = taxi.TaxiId })">
                            <input type="text" class="form-control" name="code" id="taxicode" required>
                            <span class="input-group-btn">
                                <button type="submit" class="btn btn-success btn-search"><span class="glyphicon glyphicon glyphicon-send"></span></button>
                            </span>
                        </form>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>